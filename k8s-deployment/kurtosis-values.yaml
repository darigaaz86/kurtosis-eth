# Kurtosis Cloud Controller Helm Values
# Configuration for deploying Kurtosis on Kubernetes

# Controller configuration
controller:
  # Number of controller replicas
  replicas: 1
  
  # Controller image
  image:
    repository: kurtosistech/kurtosis-cloud-controller
    tag: latest
    pullPolicy: IfNotPresent
  
  # Resource limits
  resources:
    requests:
      cpu: "500m"
      memory: "512Mi"
    limits:
      cpu: "2000m"
      memory: "2Gi"
  
  # Service account
  serviceAccount:
    create: true
    name: kurtosis-controller
    annotations: {}
  
  # RBAC
  rbac:
    create: true
    # Grant cluster-admin for full enclave management
    clusterRole: cluster-admin

# API Gateway configuration
apiGateway:
  enabled: true
  
  # Service type for external access
  service:
    type: LoadBalancer
    port: 9710
    annotations: {}
      # service.beta.kubernetes.io/aws-load-balancer-type: "nlb"
  
  # Resource limits
  resources:
    requests:
      cpu: "250m"
      memory: "256Mi"
    limits:
      cpu: "1000m"
      memory: "1Gi"

# Engine configuration
engine:
  # Default enclave namespace prefix
  enclaveNamespacePrefix: "kurtosis-"
  
  # Default resource limits for enclave pods
  defaultPodResources:
    requests:
      cpu: "1000m"
      memory: "2Gi"
    limits:
      cpu: "4000m"
      memory: "8Gi"
  
  # Default storage class for PVCs
  defaultStorageClass: "fast-ssd"
  
  # Default PVC size
  defaultPvcSize: "100Gi"
  
  # Image pull secrets (if using private registries)
  imagePullSecrets: []
  
  # Default service type for enclave services
  defaultServiceType: "ClusterIP"
  
  # Enable metrics collection
  metricsEnabled: true

# Storage configuration
storage:
  # Storage class for controller data
  storageClass: "gp3"
  
  # Size for controller persistent volume
  size: "10Gi"
  
  # Access mode
  accessMode: "ReadWriteOnce"

# Monitoring configuration
monitoring:
  # Enable Prometheus metrics
  prometheus:
    enabled: true
    port: 9090
    path: /metrics
  
  # ServiceMonitor for Prometheus Operator
  serviceMonitor:
    enabled: false
    interval: 30s
    scrapeTimeout: 10s

# Logging configuration
logging:
  # Log level (debug, info, warn, error)
  level: "info"
  
  # Log format (json, text)
  format: "json"

# Security configuration
security:
  # Pod security context
  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 1000
    fsGroup: 1000
  
  # Container security context
  containerSecurityContext:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: true
    capabilities:
      drop:
        - ALL
  
  # Network policies
  networkPolicy:
    enabled: false
    policyTypes:
      - Ingress
      - Egress

# Node selection
nodeSelector: {}
  # node-role.kubernetes.io/control-plane: ""

# Tolerations
tolerations: []
  # - key: "node-role.kubernetes.io/control-plane"
  #   operator: "Exists"
  #   effect: "NoSchedule"

# Affinity rules
affinity: {}
  # podAntiAffinity:
  #   requiredDuringSchedulingIgnoredDuringExecution:
  #   - labelSelector:
  #       matchExpressions:
  #       - key: app
  #         operator: In
  #         values:
  #         - kurtosis-controller
  #     topologyKey: kubernetes.io/hostname

# Additional environment variables
extraEnv: []
  # - name: CUSTOM_VAR
  #   value: "custom-value"

# Additional volumes
extraVolumes: []
  # - name: custom-config
  #   configMap:
  #     name: custom-config

# Additional volume mounts
extraVolumeMounts: []
  # - name: custom-config
  #   mountPath: /etc/custom

# Annotations for pods
podAnnotations: {}
  # prometheus.io/scrape: "true"
  # prometheus.io/port: "9090"

# Labels for pods
podLabels: {}
  # environment: "production"

# Priority class
priorityClassName: ""

# DNS configuration
dnsPolicy: "ClusterFirst"
dnsConfig: {}

# Host aliases
hostAliases: []

# Init containers
initContainers: []

# Sidecar containers
sidecars: []
